<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard en Tiempo Real - Sistema de Control Adaptativo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #0F172A;
            padding: 20px;
            color: white;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, #1E293B 0%, #334155 100%);
            border-radius: 12px;
            padding: 20px 30px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        .header-left h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .header-left p {
            font-size: 13px;
            color: #94A3B8;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .status-badge {
            background: #10B981;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-badge.pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .time-display {
            font-size: 18px;
            font-weight: 700;
            color: #E2E8F0;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: #1E293B;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border: 1px solid #334155;
        }

        .card-large {
            grid-column: span 2;
        }

        .card-full {
            grid-column: span 4;
        }

        .card-title {
            font-size: 14px;
            font-weight: 600;
            color: #94A3B8;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .metric-value {
            font-size: 48px;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 8px;
        }

        .metric-value.green { color: #10B981; }
        .metric-value.yellow { color: #F59E0B; }
        .metric-value.red { color: #EF4444; }
        .metric-value.blue { color: #3B82F6; }

        .metric-label {
            font-size: 12px;
            color: #64748B;
        }

        .metric-change {
            font-size: 12px;
            font-weight: 600;
            margin-top: 8px;
        }

        .metric-change.up {
            color: #10B981;
        }

        .metric-change.down {
            color: #EF4444;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #334155;
            border-radius: 6px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10B981 0%, #F59E0B 50%, #EF4444 100%);
            border-radius: 6px;
            transition: width 1s ease;
        }

        .intersection-list {
            max-height: 250px;
            overflow-y: auto;
        }

        .intersection-item {
            background: #0F172A;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .intersection-name {
            font-size: 13px;
            font-weight: 600;
            color: #E2E8F0;
        }

        .intersection-icv {
            font-size: 16px;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 6px;
        }

        .icv-low {
            background: #10B981;
            color: white;
        }

        .icv-medium {
            background: #F59E0B;
            color: white;
        }

        .icv-high {
            background: #EF4444;
            color: white;
        }

        .chart-container {
            height: 200px;
            position: relative;
        }

        canvas {
            width: 100%;
            height: 100%;
        }

        .mini-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 15px;
        }

        .mini-metric {
            background: #0F172A;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .mini-metric-label {
            font-size: 11px;
            color: #64748B;
            margin-bottom: 6px;
        }

        .mini-metric-value {
            font-size: 24px;
            font-weight: 700;
        }

        .alert-box {
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            color: #78350F;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .alert-icon {
            font-size: 24px;
        }

        .alert-text {
            flex-grow: 1;
            font-size: 12px;
            line-height: 1.5;
        }

        .activity-log {
            max-height: 180px;
            overflow-y: auto;
        }

        .activity-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
            font-size: 12px;
        }

        .activity-time {
            color: #64748B;
            font-weight: 600;
            min-width: 50px;
        }

        .activity-message {
            color: #94A3B8;
        }

        .activity-icon {
            font-size: 16px;
        }

        @media print {
            body {
                background: white;
                color: black;
            }
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #1E293B;
        }

        ::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <div class="header-left">
                <h1>üö¶ Sistema de Control Semaf√≥rico Adaptativo</h1>
                <p>Lima Centro | 31 Intersecciones Monitoreadas</p>
            </div>
            <div class="header-right">
                <div class="status-badge pulse">
                    <span>‚óè</span>
                    <span>OPERATIVO</span>
                </div>
                <div class="time-display" id="clock">--:--:--</div>
            </div>
        </div>

        <!-- MAIN METRICS -->
        <div class="grid">
            <div class="card">
                <div class="card-title">üìä ICV PROMEDIO</div>
                <div class="metric-value green" id="icv-avg">0.52</div>
                <div class="metric-label">√çndice de Congesti√≥n Vehicular</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 52%;" id="icv-bar"></div>
                </div>
                <div class="metric-change down">‚Üì 12% vs hora anterior</div>
            </div>

            <div class="card">
                <div class="card-title">üöó FLUJO VEHICULAR</div>
                <div class="metric-value blue" id="flow">8,420</div>
                <div class="metric-label">Veh√≠culos / Hora</div>
                <div class="metric-change up">‚Üë 5% vs hora anterior</div>
            </div>

            <div class="card">
                <div class="card-title">‚è±Ô∏è TIEMPO ESPERA</div>
                <div class="metric-value yellow" id="wait-time">52.3</div>
                <div class="metric-label">Segundos (Promedio)</div>
                <div class="metric-change down">‚Üì 38% vs tiempo fijo</div>
            </div>

            <div class="card">
                <div class="card-title">‚ö° VELOCIDAD MEDIA</div>
                <div class="metric-value green" id="speed">18.7</div>
                <div class="metric-label">km/h</div>
                <div class="metric-change up">‚Üë 87% vs tiempo fijo</div>
            </div>
        </div>

        <!-- SECONDARY ROW -->
        <div class="grid">
            <div class="card card-large">
                <div class="card-title">üìà EVOLUCI√ìN TEMPORAL - ICV</div>
                <div class="chart-container">
                    <canvas id="chart-icv"></canvas>
                </div>
            </div>

            <div class="card card-large">
                <div class="card-title">üéØ TOP 5 INTERSECCIONES - MAYOR CONGESTI√ìN</div>
                <div class="intersection-list">
                    <div class="intersection-item">
                        <div>
                            <div class="intersection-name">LC-015 - Av. Arequipa con Av. Javier Prado</div>
                            <div style="font-size: 11px; color: #64748B;">üìç San Isidro | 12 carriles</div>
                        </div>
                        <div class="intersection-icv icv-high">0.82</div>
                    </div>
                    <div class="intersection-item">
                        <div>
                            <div class="intersection-name">LC-008 - Av. Abancay con Av. Nicol√°s de Pi√©rola</div>
                            <div style="font-size: 11px; color: #64748B;">üìç Centro | 8 carriles</div>
                        </div>
                        <div class="intersection-icv icv-high">0.78</div>
                    </div>
                    <div class="intersection-item">
                        <div>
                            <div class="intersection-name">LC-023 - Av. Brasil con Av. Bolivia</div>
                            <div style="font-size: 11px; color: #64748B;">üìç Bre√±a | 10 carriles</div>
                        </div>
                        <div class="intersection-icv icv-medium">0.71</div>
                    </div>
                    <div class="intersection-item">
                        <div>
                            <div class="intersection-name">LC-012 - Jr. Lampa con Jr. Carabaya</div>
                            <div style="font-size: 11px; color: #64748B;">üìç Centro Hist√≥rico | 6 carriles</div>
                        </div>
                        <div class="intersection-icv icv-medium">0.68</div>
                    </div>
                    <div class="intersection-item">
                        <div>
                            <div class="intersection-name">LC-019 - Av. Tacna con Av. Grau</div>
                            <div style="font-size: 11px; color: #64748B;">üìç Centro | 8 carriles</div>
                        </div>
                        <div class="intersection-icv icv-medium">0.65</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- THIRD ROW -->
        <div class="grid">
            <div class="card">
                <div class="card-title">‚òÅÔ∏è ESTADO AZURE</div>
                <div class="mini-grid">
                    <div class="mini-metric">
                        <div class="mini-metric-label">IoT Hub</div>
                        <div class="mini-metric-value" style="color: #10B981;">‚úì</div>
                    </div>
                    <div class="mini-metric">
                        <div class="mini-metric-label">Cosmos DB</div>
                        <div class="mini-metric-value" style="color: #10B981;">‚úì</div>
                    </div>
                    <div class="mini-metric">
                        <div class="mini-metric-label">Stream Analytics</div>
                        <div class="mini-metric-value" style="color: #10B981;">‚úì</div>
                    </div>
                    <div class="mini-metric">
                        <div class="mini-metric-label">Azure ML</div>
                        <div class="mini-metric-value" style="color: #10B981;">‚úì</div>
                    </div>
                </div>
                <div style="font-size: 11px; color: #64748B; margin-top: 12px; text-align: center;">
                    Latencia P99: 152ms | √öltima sync: hace 3s
                </div>
            </div>

            <div class="card">
                <div class="card-title">ü§ñ CONTROLADOR DIFUSO</div>
                <div class="mini-grid">
                    <div class="mini-metric">
                        <div class="mini-metric-label">Ciclos/Min</div>
                        <div class="mini-metric-value" style="color: #3B82F6;">12</div>
                    </div>
                    <div class="mini-metric">
                        <div class="mini-metric-label">Latencia</div>
                        <div class="mini-metric-value" style="color: #10B981;">87ms</div>
                    </div>
                    <div class="mini-metric">
                        <div class="mini-metric-label">CPU Edge</div>
                        <div class="mini-metric-value" style="color: #F59E0B;">4.2%</div>
                    </div>
                    <div class="mini-metric">
                        <div class="mini-metric-label">Reglas Act.</div>
                        <div class="mini-metric-value" style="color: #8B5CF6;">18</div>
                    </div>
                </div>
            </div>

            <div class="card card-large">
                <div class="card-title">üìã REGISTRO DE ACTIVIDAD</div>
                <div class="activity-log">
                    <div class="activity-item">
                        <div class="activity-time">08:42:15</div>
                        <div class="activity-icon">üö®</div>
                        <div class="activity-message">
                            <strong>Veh√≠culo emergencia detectado</strong> en LC-015 | Verde inmediato activado
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-time">08:41:32</div>
                        <div class="activity-icon">üü¢</div>
                        <div class="activity-message">
                            <strong>Ola verde iniciada</strong> | Ruta: LC-001 ‚Üí LC-007 ‚Üí LC-013 (7 intersecciones)
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-time">08:40:58</div>
                        <div class="activity-icon">üìä</div>
                        <div class="activity-message">
                            <strong>Predicci√≥n CNN-LSTM:</strong> Congesti√≥n alta en 15 min (ICV proyectado: 0.78)
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-time">08:40:12</div>
                        <div class="activity-icon">üéÆ</div>
                        <div class="activity-message">
                            <strong>Modelo RL ejecutado:</strong> Optimizaci√≥n global aplicada a 31 intersecciones
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-time">08:39:45</div>
                        <div class="activity-icon">‚ö°</div>
                        <div class="activity-message">
                            <strong>Ajuste ŒîTverde:</strong> LC-008 extendido +7s (ICV=0.78, PI=0.42)
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- BOTTOM ROW -->
        <div class="grid">
            <div class="card card-full">
                <div class="card-title">üåê MAPA DE CALOR - RED DE INTERSECCIONES</div>
                <div style="display: grid; grid-template-columns: repeat(10, 1fr); gap: 8px; margin-top: 15px;">
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-001<br>0.32</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-002<br>0.38</div>
                    <div style="background: #F59E0B; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-003<br>0.55</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-004<br>0.42</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-005<br>0.28</div>
                    <div style="background: #F59E0B; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-006<br>0.61</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-007<br>0.45</div>
                    <div style="background: #EF4444; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-008<br>0.78</div>
                    <div style="background: #F59E0B; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-009<br>0.58</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-010<br>0.39</div>

                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-011<br>0.35</div>
                    <div style="background: #F59E0B; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-012<br>0.68</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-013<br>0.41</div>
                    <div style="background: #F59E0B; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-014<br>0.52</div>
                    <div style="background: #EF4444; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-015<br>0.82</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-016<br>0.37</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-017<br>0.44</div>
                    <div style="background: #F59E0B; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-018<br>0.59</div>
                    <div style="background: #F59E0B; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-019<br>0.65</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-020<br>0.33</div>

                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-021<br>0.29</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-022<br>0.46</div>
                    <div style="background: #F59E0B; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-023<br>0.71</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-024<br>0.40</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-025<br>0.31</div>
                    <div style="background: #F59E0B; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-026<br>0.54</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-027<br>0.38</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-028<br>0.43</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-029<br>0.36</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-030<br>0.27</div>
                    <div style="background: #10B981; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700;">LC-031<br>0.34</div>
                </div>
                <div style="display: flex; justify-content: center; gap: 30px; margin-top: 20px; font-size: 12px;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 20px; height: 20px; background: #10B981; border-radius: 4px;"></div>
                        <span>Bajo (0.0-0.5)</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 20px; height: 20px; background: #F59E0B; border-radius: 4px;"></div>
                        <span>Medio (0.5-0.7)</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 20px; height: 20px; background: #EF4444; border-radius: 4px;"></div>
                        <span>Alto (0.7-1.0)</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Clock
        function updateClock() {
            const now = new Date();
            document.getElementById('clock').textContent = now.toLocaleTimeString('es-PE');
        }
        setInterval(updateClock, 1000);
        updateClock();

        // Chart - ICV Evolution
        const canvas = document.getElementById('chart-icv');
        const ctx = canvas.getContext('2d');
        canvas.width = 600;
        canvas.height = 200;

        const data = [0.58, 0.62, 0.59, 0.55, 0.52, 0.48, 0.51, 0.53, 0.50, 0.52];
        const labels = ['08:33', '08:34', '08:35', '08:36', '08:37', '08:38', '08:39', '08:40', '08:41', '08:42'];

        const padding = 40;
        const chartWidth = canvas.width - padding * 2;
        const chartHeight = canvas.height - padding * 2;
        const stepX = chartWidth / (data.length - 1);

        // Axes
        ctx.strokeStyle = '#475569';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(padding, padding);
        ctx.lineTo(padding, padding + chartHeight);
        ctx.lineTo(padding + chartWidth, padding + chartHeight);
        ctx.stroke();

        // Grid lines
        ctx.strokeStyle = '#334155';
        ctx.lineWidth = 1;
        for (let i = 1; i <= 4; i++) {
            const y = padding + (chartHeight / 4) * i;
            ctx.beginPath();
            ctx.moveTo(padding, y);
            ctx.lineTo(padding + chartWidth, y);
            ctx.stroke();
        }

        // Data line
        ctx.strokeStyle = '#10B981';
        ctx.lineWidth = 3;
        ctx.beginPath();
        data.forEach((value, i) => {
            const x = padding + i * stepX;
            const y = padding + chartHeight - (value * chartHeight);
            if (i === 0) {
                ctx.moveTo(x, y);
            } else {
                ctx.lineTo(x, y);
            }
        });
        ctx.stroke();

        // Data points
        data.forEach((value, i) => {
            const x = padding + i * stepX;
            const y = padding + chartHeight - (value * chartHeight);
            ctx.fillStyle = '#10B981';
            ctx.beginPath();
            ctx.arc(x, y, 4, 0, Math.PI * 2);
            ctx.fill();
        });

        // Labels
        ctx.fillStyle = '#94A3B8';
        ctx.font = '11px Segoe UI';
        ctx.textAlign = 'center';
        labels.forEach((label, i) => {
            if (i % 2 === 0) {
                const x = padding + i * stepX;
                ctx.fillText(label, x, canvas.height - 10);
            }
        });

        // Y-axis labels
        ctx.textAlign = 'right';
        ctx.fillText('1.0', padding - 10, padding + 5);
        ctx.fillText('0.5', padding - 10, padding + chartHeight / 2 + 5);
        ctx.fillText('0.0', padding - 10, padding + chartHeight + 5);

        // Simulate real-time updates
        setInterval(() => {
            const randomIcv = (0.45 + Math.random() * 0.15).toFixed(2);
            document.getElementById('icv-avg').textContent = randomIcv;
            document.getElementById('icv-bar').style.width = (randomIcv * 100) + '%';

            const randomFlow = Math.floor(8000 + Math.random() * 1000);
            document.getElementById('flow').textContent = randomFlow.toLocaleString();

            const randomWait = (48 + Math.random() * 10).toFixed(1);
            document.getElementById('wait-time').textContent = randomWait;

            const randomSpeed = (16 + Math.random() * 5).toFixed(1);
            document.getElementById('speed').textContent = randomSpeed;
        }, 3000);
    </script>
</body>
</html>
