<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√°lculo del ICV - √çndice de Congesti√≥n Vehicular</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #F9FAFB;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 800px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            padding: 40px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 26px;
            font-weight: 700;
            color: #1E293B;
            margin-bottom: 8px;
        }

        .subtitle {
            font-size: 14px;
            color: #64748B;
        }

        .step {
            background: #F9FAFB;
            border-left: 4px solid #0078D4;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .step-number {
            display: inline-block;
            background: #0078D4;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: 700;
            font-size: 14px;
            margin-right: 10px;
        }

        .step-title {
            font-size: 16px;
            font-weight: 700;
            color: #1E293B;
            margin-bottom: 12px;
        }

        .step-content {
            font-size: 13px;
            color: #475569;
            line-height: 1.7;
            margin-left: 40px;
        }

        .formula-box {
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid #F59E0B;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }

        .formula {
            font-size: 18px;
            font-weight: 700;
            color: #78350F;
            text-align: center;
            margin-bottom: 10px;
        }

        .formula-desc {
            font-size: 12px;
            color: #92400E;
            text-align: center;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 13px;
        }

        .data-table th {
            background: #0078D4;
            color: white;
            padding: 10px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            padding: 10px;
            border-bottom: 1px solid #E5E7EB;
        }

        .data-table tr:hover {
            background: #F9FAFB;
        }

        .highlight {
            background: #DBEAFE;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 700;
            color: #1E40AF;
        }

        .result-box {
            background: linear-gradient(135deg, #10B981 0%, #059669 100%);
            border-radius: 10px;
            padding: 25px;
            color: white;
            text-align: center;
            margin-top: 25px;
        }

        .result-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .result-value {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .result-label {
            font-size: 13px;
            opacity: 0.9;
        }

        .info-card {
            background: #DBEAFE;
            border-left: 4px solid #3B82F6;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            font-size: 12px;
            color: #1E40AF;
        }

        .info-card strong {
            display: block;
            margin-bottom: 5px;
            font-size: 13px;
        }

        .visual-bar {
            width: 100%;
            height: 40px;
            background: #E5E7EB;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            margin: 10px 0;
        }

        .visual-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #10B981 0%, #F59E0B 50%, #EF4444 100%);
            border-radius: 8px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: 700;
            font-size: 14px;
        }

        .range-labels {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: #64748B;
            margin-top: 5px;
        }

        .calculation-step {
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #1E293B;
        }

        .arrow-down {
            text-align: center;
            font-size: 24px;
            color: #94A3B8;
            margin: 10px 0;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="title">C√ÅLCULO DEL ICV</div>
            <div class="subtitle">√çndice de Congesti√≥n Vehicular - Paso a Paso</div>
        </div>

        <!-- PASO 1 -->
        <div class="step">
            <div class="step-title">
                <span class="step-number">1</span>
                DETECTAR VEH√çCULOS CON YOLO
            </div>
            <div class="step-content">
                El sistema procesa frames de video a <strong>20 FPS</strong> utilizando <strong>YOLOv8n</strong>
                para detectar veh√≠culos en tiempo real. Se obtiene el n√∫mero de veh√≠culos detectados en el √°rea de inter√©s.
            </div>
            <div class="info-card">
                <strong>üì∏ Datos de entrada del frame actual:</strong>
                Timestamp: 2025-01-15 08:45:32 | C√°mara: LC-001 (Av. Abancay con Jr. Lampa)
            </div>
            <table class="data-table">
                <tr>
                    <th>M√©trica</th>
                    <th>Valor Medido</th>
                    <th>Unidad</th>
                </tr>
                <tr>
                    <td>Veh√≠culos detectados</td>
                    <td class="highlight">18</td>
                    <td>veh√≠culos</td>
                </tr>
                <tr>
                    <td>√Årea monitoreada</td>
                    <td>150</td>
                    <td>m¬≤</td>
                </tr>
                <tr>
                    <td>Capacidad m√°xima</td>
                    <td>25</td>
                    <td>veh√≠culos</td>
                </tr>
            </table>
        </div>

        <!-- PASO 2 -->
        <div class="step">
            <div class="step-title">
                <span class="step-number">2</span>
                CALCULAR DENSIDAD VEHICULAR
            </div>
            <div class="step-content">
                La densidad vehicular se calcula dividiendo el n√∫mero de veh√≠culos detectados
                entre la capacidad m√°xima del √°rea de observaci√≥n.
            </div>
            <div class="formula-box">
                <div class="formula">œÅ = N / N_max</div>
                <div class="formula-desc">Donde: N = veh√≠culos actuales, N_max = capacidad m√°xima</div>
            </div>
            <div class="calculation-step">
                œÅ = 18 / 25 = <span class="highlight">0.72</span>
            </div>
        </div>

        <div class="arrow-down">‚ñº</div>

        <!-- PASO 3 -->
        <div class="step">
            <div class="step-title">
                <span class="step-number">3</span>
                MEDIR VELOCIDAD PROMEDIO
            </div>
            <div class="step-content">
                Utilizando <strong>ByteTrack</strong> para el seguimiento de veh√≠culos, se calcula
                la velocidad promedio en la intersecci√≥n durante la ventana de observaci√≥n (5 segundos).
            </div>
            <table class="data-table">
                <tr>
                    <th>Veh√≠culo ID</th>
                    <th>Velocidad (km/h)</th>
                    <th>Estado</th>
                </tr>
                <tr>
                    <td>Track-001</td>
                    <td>8.5</td>
                    <td>üî¥ Lento</td>
                </tr>
                <tr>
                    <td>Track-002</td>
                    <td>12.3</td>
                    <td>üü° Moderado</td>
                </tr>
                <tr>
                    <td>Track-003</td>
                    <td>5.2</td>
                    <td>üî¥ Lento</td>
                </tr>
                <tr>
                    <td colspan="3" style="text-align: center; font-weight: 700; background: #F9FAFB;">
                        Velocidad promedio: <span class="highlight">8.67 km/h</span>
                    </td>
                </tr>
            </table>
        </div>

        <!-- PASO 4 -->
        <div class="step">
            <div class="step-title">
                <span class="step-number">4</span>
                NORMALIZAR VELOCIDAD
            </div>
            <div class="step-content">
                Se normaliza la velocidad medida respecto a la velocidad de flujo libre t√≠pica
                de zonas urbanas (40 km/h en Lima Centro).
            </div>
            <div class="formula-box">
                <div class="formula">v_norm = v_actual / v_libre</div>
                <div class="formula-desc">Donde: v_libre = 40 km/h (velocidad de flujo libre urbano)</div>
            </div>
            <div class="calculation-step">
                v_norm = 8.67 / 40 = <span class="highlight">0.217</span>
            </div>
        </div>

        <div class="arrow-down">‚ñº</div>

        <!-- PASO 5 -->
        <div class="step">
            <div class="step-title">
                <span class="step-number">5</span>
                CALCULAR ICV FINAL
            </div>
            <div class="step-content">
                El ICV combina densidad vehicular (œÅ) con el inverso de la velocidad normalizada.
                A mayor densidad y menor velocidad, mayor congesti√≥n.
            </div>
            <div class="formula-box">
                <div class="formula">ICV = (œÅ + (1 - v_norm)) / 2</div>
                <div class="formula-desc">
                    Ponderaci√≥n 50/50 entre densidad e inverso de velocidad
                </div>
            </div>
            <div class="calculation-step">
                ICV = (0.72 + (1 - 0.217)) / 2
                <br>ICV = (0.72 + 0.783) / 2
                <br>ICV = 1.503 / 2
                <br>ICV = <span class="highlight">0.7515</span>
            </div>
            <div class="info-card">
                <strong>üîß Nota t√©cnica:</strong>
                El ICV se normaliza autom√°ticamente al rango [0.0, 1.0] donde:
                <br>‚Ä¢ 0.0 = Sin congesti√≥n (flujo libre)
                <br>‚Ä¢ 0.5 = Congesti√≥n moderada
                <br>‚Ä¢ 1.0 = Congesti√≥n severa (tr√°fico detenido)
            </div>
        </div>

        <!-- RESULTADO -->
        <div class="result-box">
            <div class="result-title">üéØ RESULTADO FINAL</div>
            <div class="result-value">0.75</div>
            <div class="result-label">ICV - CONGESTI√ìN ALTA</div>
        </div>

        <!-- VISUALIZACI√ìN -->
        <div style="margin-top: 25px;">
            <strong style="display: block; margin-bottom: 10px; color: #1E293B; font-size: 14px;">
                üìä Representaci√≥n Visual del ICV
            </strong>
            <div class="visual-bar">
                <div class="visual-bar-fill" style="width: 75%;">
                    ICV = 0.75
                </div>
            </div>
            <div class="range-labels">
                <span>üü¢ Bajo (0.0 - 0.3)</span>
                <span>üü° Medio (0.3 - 0.7)</span>
                <span>üî¥ Alto (0.7 - 1.0)</span>
            </div>
        </div>

        <!-- APLICACI√ìN -->
        <div style="margin-top: 30px; padding-top: 25px; border-top: 2px solid #E5E7EB;">
            <div style="font-size: 16px; font-weight: 700; color: #1E293B; margin-bottom: 15px;">
                ‚öôÔ∏è APLICACI√ìN EN EL CONTROLADOR DIFUSO
            </div>
            <div style="font-size: 13px; color: #475569; line-height: 1.7;">
                El valor <strong class="highlight">ICV = 0.75</strong> se utiliza como entrada del sistema difuso:
                <br><br>
                <strong>Fuzzificaci√≥n:</strong>
                <br>‚Ä¢ Œº_Bajo(0.75) = 0.00
                <br>‚Ä¢ Œº_Medio(0.75) = 0.00
                <br>‚Ä¢ Œº_Alto(0.75) = <span class="highlight">1.00</span> ‚úì
                <br><br>
                <strong>Reglas activadas:</strong> Grupo de reglas para ICV="Alto" que generalmente
                resultan en <strong style="color: #10B981;">Extender</strong> o
                <strong style="color: #22C55E;">Extender Mucho</strong> el tiempo de verde.
            </div>
        </div>

        <!-- FOOTER METADATA -->
        <div style="margin-top: 30px; padding: 15px; background: #F9FAFB; border-radius: 8px; font-size: 11px; color: #64748B;">
            <strong style="display: block; margin-bottom: 8px; color: #1E293B;">üî¨ METADATOS DEL C√ÅLCULO</strong>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                <div>Frecuencia de c√°lculo: <strong>200 ms (5 Hz)</strong></div>
                <div>Ventana temporal: <strong>5 segundos</strong></div>
                <div>Algoritmo detecci√≥n: <strong>YOLOv8n</strong></div>
                <div>Algoritmo tracking: <strong>ByteTrack</strong></div>
                <div>Hardware: <strong>Raspberry Pi 5 (8GB)</strong></div>
                <div>Latencia promedio: <strong>&lt; 95 ms</strong></div>
            </div>
        </div>
    </div>

    <script>
        // Animaci√≥n de entrada de la barra visual
        window.addEventListener('load', () => {
            const bar = document.querySelector('.visual-bar-fill');
            bar.style.width = '0%';
            setTimeout(() => {
                bar.style.width = '75%';
            }, 300);
        });
    </script>
</body>
</html>
